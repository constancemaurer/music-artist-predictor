# music-artist-predictor

**General Assembly | Data Science Immersive | Capstone Project**

<img src="images/Screenshot 2020-06-05 at 11.12.01.png">


general discription

## Problem Statement

Can we predict a music artist by his/her songs' spotify music features, popularity score and lyrics?

## Goals

1.
2.


## Methodology

1. Select artists from a Spotify Dataset published on Kaggle.

2. Retrieve lyrics from artists' songs through Genius API and webscrapping with BeautifulSoup. Alternatively with a Python API wrapper called lyricsgenius by johnwmillr.

3. Establish SQL database

4. Merge datasets.

5. Clean data of missing values, duplicates and other anomalies.

6. Perform sentimental analysis and other NLP analysis to derive NLP-based continous features.

7. Prepare training and testing set.

8. Prepare count and TF-IDF vectorised features.

9. Perform standarisation.

10. *Perform Principal Component Analysis to establish feature importance and reduce the number of features.*

11. *STATSMODELS?*

12. *Cluster Analysis*

13. Model Selection by testing different Classifiers.

14. Model Optimisation and Evaluation with Accuracy, Precision and Recall.

15. Findings and Limitations

## Python Libraries


## Data Collection

Data was collected from Spotify Track Dataset from Kaggle (link) and from Genius Lyrics website using the lyricsgenius wrapper by johnwmillr
 (link) utlising Genius APIs and BeautifulSoup webscraping.
 
 feature table
 
 
## Data Preparation/Cleaning/Wrangling

## Model Selection

First only four models (KNN, Logistic Regression, Random Forest, and Support Vector Machines) were tested with a GridsearchCV using only a few parameters per model on the engineered features and the lyrics processed with either scikit-learn's CountVectorizer or TfidfVectorizer.

It was found that the ...Vectorizer seemed to yield better Cross Validation Scores.

Table of tfidf and cvec from first testing.


Following a thourough GridSearchCV Procedure with multiple classification models (see Table below), it was found that Random Forest was performing the best out of the 16 models.

| Model    Parameters    Processing    Train: Accuracy    Train: Precision    Train: Recall    Train: F1    Test: Accuracy    Test: Precision    Test: Recall    Test: F1    Cross-Val Score |                                                                                                                                                    |                            |                     |  | 
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|---------------------|--| 
| KNN    "KNeighborsClassifier(algorithm='auto'                                                                                                                                              |  leaf_size=30                                                                                                                                      |  metric='euclidean'        |                     |  | 
|                      metric_params=None                                                                                                                                                    |  n_jobs=None                                                                                                                                       |  n_neighbors=27            |  p=2                |  | 
|                      weights='distance')"    StandardScaler()    1    1    1    1    0.201    0.217    0.131    0.119    0.163312693498452                                                 |                                                                                                                                                    |                            |                     |  | 
| Logistic Regression L1    "LogisticRegression(C=5.689866029018296                                                                                                                          |  class_weight=None                                                                                                                                 |  dual=False                |                     |  | 
|                    fit_intercept=True                                                                                                                                                      |  intercept_scaling=1                                                                                                                               |  l1_ratio=None             |                     |  | 
|                    max_iter=1000                                                                                                                                                           |  multi_class='ovr'                                                                                                                                 |  n_jobs=None               |  penalty='l1'       |  | 
|                    random_state=None                                                                                                                                                       |  solver='liblinear'                                                                                                                                |  tol=0.0001                |  verbose=0          |  | 
|                    warm_start=False)"    StandardScaler()    1    1    1    1    0.418    0.402    0.341    0.347    0.34984520123839                                                      |                                                                                                                                                    |                            |                     |  | 
| Logistic Regression L2    "LogisticRegression(C=0.15998587196060582                                                                                                                        |  class_weight=None                                                                                                                                 |  dual=False                |                     |  | 
|                    fit_intercept=True                                                                                                                                                      |  intercept_scaling=1                                                                                                                               |  l1_ratio=None             |                     |  | 
|                    max_iter=1000                                                                                                                                                           |  multi_class='multinomial'                                                                                                                         |  n_jobs=None               |                     |  | 
|                    penalty='l2'                                                                                                                                                            |  random_state=None                                                                                                                                 |  solver='sag'              |  tol=0.0001         |  | 
|                    verbose=0, warm_start=False)"    StandardScaler()    1    1    1    1    0.464    0.453    0.375    0.385    0.440402476780186                                          |                                                                                                                                                    |                            |                     |  | 
| Decision Tree    "DecisionTreeClassifier(class_weight=None                                                                                                                                 |  criterion='gini'                                                                                                                                  |  max_depth=11              |                     |  | 
|                        max_features=900                                                                                                                                                    |  max_leaf_nodes=None                                                                                                                               |                            |                     |  | 
|                        min_impurity_decrease=0.0                                                                                                                                           |  min_impurity_split=None                                                                                                                           |                            |                     |  | 
|                        min_samples_leaf=1                                                                                                                                                  |  min_samples_split=40                                                                                                                              |                            |                     |  | 
|                        min_weight_fraction_leaf=0.0                                                                                                                                        |  presort=False                                                                                                                                     |                            |                     |  | 
|                        random_state=42, splitter='best')"    StandardScaler()    0.483    0.436    0.403    0.391    0.282    0.298    0.219    0.223    0.288699690402477                 |                                                                                                                                                    |                            |                     |  | 
| Bagging with KNN    "BaggingClassifier(base_estimator=KNeighborsClassifier(algorithm='auto'                                                                                                |                                                                                                                                                    |                            |                     |  | 
|                                                       leaf_size=30                                                                                                                         |                                                                                                                                                    |                            |                     |  | 
|                                                       metric='minkowski'                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                                                       metric_params=None                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                                                       n_jobs=None                                                                                                                          |                                                                                                                                                    |                            |                     |  | 
|                                                       n_neighbors=5                                                                                                                        |  p=2                                                                                                                                               |                            |                     |  | 
|                                                       weights='uniform')                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                   bootstrap=True                                                                                                                                                           |  bootstrap_features=False                                                                                                                          |  max_features=28           |                     |  | 
|                   max_samples=1.0                                                                                                                                                          |  n_estimators=100                                                                                                                                  |  n_jobs=None               |                     |  | 
|                   oob_score=False                                                                                                                                                          |  random_state=None                                                                                                                                 |  verbose=0                 |                     |  | 
|                   warm_start=False)"    StandardScaler()    0.998    0.999    0.995    0.997    0.257    0.186    0.155    0.136    0.26702786377709                                       |                                                                                                                                                    |                            |                     |  | 
| Bagging with best KNN    "BaggingClassifier(base_estimator=KNeighborsClassifier(algorithm='auto'                                                                                           |                                                                                                                                                    |                            |                     |  | 
|                                                       leaf_size=30                                                                                                                         |                                                                                                                                                    |                            |                     |  | 
|                                                       metric='euclidean'                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                                                       metric_params=None                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                                                       n_jobs=None                                                                                                                          |                                                                                                                                                    |                            |                     |  | 
|                                                       n_neighbors=27                                                                                                                       |  p=2                                                                                                                                               |                            |                     |  | 
|                                                       weights='distance')                                                                                                                  |                                                                                                                                                    |                            |                     |  | 
|                   bootstrap=True                                                                                                                                                           |  bootstrap_features=False                                                                                                                          |  max_features=30           |                     |  | 
|                   max_samples=1.0                                                                                                                                                          |  n_estimators=100                                                                                                                                  |  n_jobs=None               |                     |  | 
|                   oob_score=False                                                                                                                                                          |  random_state=None                                                                                                                                 |  verbose=0                 |                     |  | 
|                   warm_start=False)"    StandardScaler()    1    1    1    1    0.251    0.253    0.154    0.148    0.25                                                                   |                                                                                                                                                    |                            |                     |  | 
| Bagging with Decision Tree    "BaggingClassifier(base_estimator=DecisionTreeClassifier(class_weight=None                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                                                         criterion='gini'                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                                                         max_depth=None                                                                                                                     |                                                                                                                                                    |                            |                     |  | 
|                                                         max_features=None                                                                                                                  |                                                                                                                                                    |                            |                     |  | 
|                                                         max_leaf_nodes=None                                                                                                                |                                                                                                                                                    |                            |                     |  | 
|                                                         min_impurity_decrease=0.0                                                                                                          |                                                                                                                                                    |                            |                     |  | 
|                                                         min_impurity_split=None                                                                                                            |                                                                                                                                                    |                            |                     |  | 
|                                                         min_samples_leaf=1                                                                                                                 |                                                                                                                                                    |                            |                     |  | 
|                                                         min_samples_split=2                                                                                                                |                                                                                                                                                    |                            |                     |  | 
|                                                         min_weight_fraction_leaf=0.0                                                                                                       |                                                                                                                                                    |                            |                     |  | 
|                                                         presort=False                                                                                                                      |                                                                                                                                                    |                            |                     |  | 
|                                                         random_state=None                                                                                                                  |                                                                                                                                                    |                            |                     |  | 
|                                                         splitter='best')                                                                                                                   |                                                                                                                                                    |                            |                     |  | 
|                   bootstrap=True                                                                                                                                                           |  bootstrap_features=False                                                                                                                          |  max_features=31           |                     |  | 
|                   max_samples=1.0                                                                                                                                                          |  n_estimators=100                                                                                                                                  |  n_jobs=None               |                     |  | 
|                   oob_score=False                                                                                                                                                          |  random_state=None                                                                                                                                 |  verbose=0                 |                     |  | 
|                   warm_start=False)"    StandardScaler()    1    1    1    1    0.288    0.201    0.194    0.175    0.280070025571912                                                      |                                                                                                                                                    |                            |                     |  | 
| AdaBoostClassifier with Decision Tree    "AdaBoostClassifier(algorithm='SAMME.R'                                                                                                           |                                                                                                                                                    |                            |                     |  | 
|                    base_estimator=DecisionTreeClassifier(class_weight=None                                                                                                                 |                                                                                                                                                    |                            |                     |  | 
|                                                          criterion='gini'                                                                                                                  |                                                                                                                                                    |                            |                     |  | 
|                                                          max_depth=None                                                                                                                    |                                                                                                                                                    |                            |                     |  | 
|                                                          max_features=None                                                                                                                 |                                                                                                                                                    |                            |                     |  | 
|                                                          max_leaf_nodes=None                                                                                                               |                                                                                                                                                    |                            |                     |  | 
|                                                          min_impurity_decrease=0.0                                                                                                         |                                                                                                                                                    |                            |                     |  | 
|                                                          min_impurity_split=None                                                                                                           |                                                                                                                                                    |                            |                     |  | 
|                                                          min_samples_leaf=1                                                                                                                |                                                                                                                                                    |                            |                     |  | 
|                                                          min_samples_split=2                                                                                                               |                                                                                                                                                    |                            |                     |  | 
|                                                          min_weight_fraction_leaf=0.0                                                                                                      |                                                                                                                                                    |                            |                     |  | 
|                                                          presort=False                                                                                                                     |                                                                                                                                                    |                            |                     |  | 
|                                                          random_state=None                                                                                                                 |                                                                                                                                                    |                            |                     |  | 
|                                                          splitter='best')                                                                                                                  |                                                                                                                                                    |                            |                     |  | 
|                    learning_rate=0.1, n_estimators=50, random_state=42)"    StandardScaler()    1    1    1    1    0.266    0.204    0.196    0.195    0.259287925696594                  |                                                                                                                                                    |                            |                     |  | 
| Bernoulli Naive Bayes    "BernoulliNB(alpha=0.2631578947368421                                                                                                                             |  binarize=0.0                                                                                                                                      |  class_prior=None          |                     |  | 
|             fit_prior=True)"    StandardScaler()    0.941    0.964    0.938    0.948    0.508    0.516    0.409    0.42    0.46671826625387                                                |                                                                                                                                                    |                            |                     |  | 
| Gaussian Naive Bayes    GaussianNB(priors=None                                                                                                                                             |  var_smoothing=0.3673469394081633)    StandardScaler()    0.989    0.978    0.99    0.983    0.282    0.237    0.243    0.227    0.251547987616099 |                            |                     |  | 
| Support Vector Classifier - rbf    "SVC(C=1.0                                                                                                                                              |  cache_size=200                                                                                                                                    |  class_weight=None         |  coef0=0.0          |  | 
|     decision_function_shape='ovr'                                                                                                                                                          |  degree=3                                                                                                                                          |  gamma=0.05555555555555555 |                     |  | 
|     kernel='rbf'                                                                                                                                                                           |  max_iter=-1                                                                                                                                       |  probability=False         |  random_state=None  |  | 
|     shrinking=True, tol=0.001, verbose=False)"    StandardScaler()    1    1    1    1    0.108    0.027    0.046    0.025    0.0790376109919568                                           |                                                                                                                                                    |                            |                     |  | 
| Support Vector Classifier - poly    "SVC(C=0.01                                                                                                                                            |  cache_size=200                                                                                                                                    |  class_weight=None         |  coef0=0.0          |  | 
|     decision_function_shape='ovr'                                                                                                                                                          |  degree=3                                                                                                                                          |  gamma=0.0                 |  kernel='poly'      |  | 
|     max_iter=-1                                                                                                                                                                            |  probability=False                                                                                                                                 |  random_state=None         |  shrinking=True     |  | 
|     tol=0.001, verbose=False)"    StandardScaler()    0.073    0.002    0.026    0.003    0.071    0.002    0.026    0.003    0.0727554179566563                                           |                                                                                                                                                    |                            |                     |  | 
| Support Vector Classifier - rbf    "SVC(C=1.0615789473684212                                                                                                                               |  cache_size=200                                                                                                                                    |  class_weight=None         |  coef0=0.0          |  | 
|     decision_function_shape='ovr'                                                                                                                                                          |  degree=3                                                                                                                                          |  gamma=0.1111111111111111  |                     |  | 
|     kernel='rbf'                                                                                                                                                                           |  max_iter=-1                                                                                                                                       |  probability=False         |  random_state=None  |  | 
|     shrinking=True, tol=0.001, verbose=False)"    StandardScaler()    1    1    1    1    0.108    0.027    0.046    0.025    0.0790376109919568                                           |                                                                                                                                                    |                            |                     |  | 
| Support Vector Classifier - sigmoid    "SVC(C=0.27263157894736845                                                                                                                          |  cache_size=200                                                                                                                                    |  class_weight=None         |  coef0=0.0          |  | 
|     decision_function_shape='ovr'                                                                                                                                                          |  degree=3                                                                                                                                          |  gamma=0.1111111111111111  |                     |  | 
|     kernel='sigmoid'                                                                                                                                                                       |  max_iter=-1                                                                                                                                       |  probability=False         |  random_state=None  |  | 
|     shrinking=True, tol=0.001, verbose=False)"    StandardScaler()    0.149    0.128    0.114    0.115    0.322    0.261    0.252    0.247    0.307275541795666                            |                                                                                                                                                    |                            |                     |  | 
| Logistic Regression                                                                                                                                                                        |  Saga Solver    "LogisticRegression(C=1.6037187437513303                                                                                           |  class_weight=None         |  dual=False         |  | 
|                    fit_intercept=True                                                                                                                                                      |  intercept_scaling=1                                                                                                                               |  l1_ratio=None             |                     |  | 
|                    max_iter=1000                                                                                                                                                           |  multi_class='auto'                                                                                                                                |  n_jobs=None               |  penalty='l2'       |  | 
|                    random_state=None                                                                                                                                                       |  solver='saga'                                                                                                                                     |  tol=0.0001                |  verbose=0          |  | 
|                    warm_start=False)"    StandardScaler()    1    1    1    1    0.467    0.456    0.377    0.388    0.436532507739938                                                     |                                                                                                                                                    |                            |                     |  | 
| Random Forest    "RandomForestClassifier(bootstrap=True                                                                                                                                    |  class_weight=None                                                                                                                                 |  criterion='gini'          |                     |  | 
|                        max_depth=50                                                                                                                                                        |  max_features=200                                                                                                                                  |  max_leaf_nodes=None       |                     |  | 
|                        min_impurity_decrease=0.0                                                                                                                                           |  min_impurity_split=None                                                                                                                           |                            |                     |  | 
|                        min_samples_leaf=1                                                                                                                                                  |  min_samples_split=2                                                                                                                               |                            |                     |  | 
|                        min_weight_fraction_leaf=0.0                                                                                                                                        |  n_estimators=500                                                                                                                                  |                            |                     |  | 
|                        n_jobs=None                                                                                                                                                         |  oob_score=False                                                                                                                                   |  random_state=42           |  verbose=0          |  | 
|                        warm_start=False)"    StandardScaler()    1    1    1    1    0.458    0.427    0.351    0.346    0.482239154597336                                                 |                                                                                                                                                    |                            |                     |  | 
| Random Forest    "RandomForestClassifier(bootstrap=True                                                                                                                                    |  class_weight=None                                                                                                                                 |  criterion='gini'          |                     |  | 
|                        max_depth=40                                                                                                                                                        |  max_features=150                                                                                                                                  |  max_leaf_nodes=None       |                     |  | 
|                        min_impurity_decrease=0.0                                                                                                                                           |  min_impurity_split=None                                                                                                                           |                            |                     |  | 
|                        min_samples_leaf=1                                                                                                                                                  |  min_samples_split=2                                                                                                                               |                            |                     |  | 
|                        min_weight_fraction_leaf=0.0                                                                                                                                        |  n_estimators=500                                                                                                                                  |                            |                     |  | 
|                        n_jobs=None                                                                                                                                                         |  oob_score=False                                                                                                                                   |  random_state=42           |  verbose=0          |  | 
|                        warm_start=False)"    StandardScaler()    1    1    1    1    0.467    0.416    0.356    0.349    0.48374613003096                                                  |                                                                                                                                                    |                            |                     |  | 
| Gradient Boosting Classifier    "GradientBoostingClassifier(criterion='mse'                                                                                                                |  init=None                                                                                                                                         |  learning_rate=1.0         |                     |  | 
|                            loss='deviance'                                                                                                                                                 |  max_depth=3                                                                                                                                       |  max_features=None         |                     |  | 
|                            max_leaf_nodes=None                                                                                                                                             |  min_impurity_decrease=0.0                                                                                                                         |                            |                     |  | 
|                            min_impurity_split=None                                                                                                                                         |  min_samples_leaf=1                                                                                                                                |                            |                     |  | 
|                            min_samples_split=2                                                                                                                                             |  min_weight_fraction_leaf=0.0                                                                                                                      |                            |                     |  | 
|                            n_estimators=100                                                                                                                                                |  n_iter_no_change=None                                                                                                                             |                            |                     |  | 
|                            presort='auto'                                                                                                                                                  |  random_state=1                                                                                                                                    |  subsample=1.0             |                     |  | 
|                            tol=0.0001                                                                                                                                                      |  validation_fraction=0.1                                                                                                                           |  verbose=0                 |                     |  | 
|                            warm_start=False)"    StandardScaler()    0.032    0.274    0.027    0.033    0.022    0.011    0.017    0.008    0.158054536946711                             |                                                                                                                                                    |                            |                     |  | 
| Linear Support Vector Classifier    "LinearSVC(C=0.001                                                                                                                                     |  class_weight=None                                                                                                                                 |  dual=True                 |  fit_intercept=True |  | 
|           intercept_scaling=1                                                                                                                                                              |  loss='squared_hinge'                                                                                                                              |  max_iter=1000             |                     |  | 
|           multi_class='ovr'                                                                                                                                                                |  penalty='l2'                                                                                                                                      |  random_state=None         |  tol=0.0001         |  | 
|           verbose=0)"    StandardScaler()    0.998    0.999    0.995    0.997    0.384    0.341    0.292    0.293    0.375                                                                 |                                                                                                                                                    |                            |                     |  | 


## Model Optimisation & Evaluation

## Results

## Analysis

## Further Steps

## Conclusion
